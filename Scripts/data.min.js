    const elementoAudio = new Audio();
    elementoAudio.crossOrigin = "anonymous";
    elementoAudio.src = 'https://buecrplb01.cienradios.com.ar/Mitre790.aac';

    const botonReproducirPausar = document.getElementById('botonReproducirPausar');
    const controlVolumen = document.getElementById('controlVolumen');
    const elementoEstado = document.getElementById('estado');
    const botonAlternarEcualizador = document.getElementById('alternarEcualizador');
    const divEcualizador = document.getElementById('ecualizador');
    const botonAlternarTema = document.getElementById('alternarTema');
    const botonAlternarEstaciones = document.getElementById('alternarEstaciones');
    const botonAlternarMenu = document.getElementById('alternarMenu');
    const listaEstaciones = document.getElementById('listaEstaciones');
    const listaMenu = document.getElementById('listaMenu');
    const imagenReproduciendo = document.getElementById('imagen-reproduciendo');
    let estaReproduciendo = false;

    botonReproducirPausar.addEventListener('click', alternarReproducirPausar);
    controlVolumen.addEventListener('input', ajustarVolumen);
    botonAlternarEcualizador.addEventListener('click', alternarEcualizador);
    botonAlternarTema.addEventListener('click', alternarTema);
    botonAlternarEstaciones.addEventListener('click', alternarEstaciones);
    botonAlternarMenu.addEventListener('click', alternarMenu);

    function alternarReproducirPausar() {
        if (estaReproduciendo) {
            elementoAudio.pause();
            botonReproducirPausar.innerHTML = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>';
            elementoEstado.textContent = '';
        } else {
            elementoAudio.play().then(() => {
                botonReproducirPausar.innerHTML = '<svg viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';
                elementoEstado.textContent = '';
            }).catch(e => {
                console.error('Error en inicialización:', e);
                elementoEstado.textContent = 'No se puede reproducir la estación';
            });
        }
        estaReproduciendo = !estaReproduciendo;
    }

    function ajustarVolumen() {
        elementoAudio.volume = controlVolumen.value;
    }

    function alternarEcualizador() {
        if (divEcualizador.style.display === 'none') {
            divEcualizador.style.display = 'flex';
            botonAlternarEcualizador.textContent = 'Ocultar Ecualizador';
        } else {
            divEcualizador.style.display = 'none';
            botonAlternarEcualizador.textContent = 'Mostrar Ecualizador';
        }
    }

    function alternarTema() {
        document.body.setAttribute('data-tema', document.body.getAttribute('data-tema') === 'oscuro' ? 'claro' : 'oscuro');
    }

    function alternarEstaciones() {
        listaEstaciones.style.display = listaEstaciones.style.display === 'none' ? 'block' : 'none';
        listaMenu.style.display = 'none';
    }

    function alternarMenu() {
        listaMenu.style.display = listaMenu.style.display === 'none' ? 'block' : 'none';
        listaEstaciones.style.display = 'none';
    }

    listaEstaciones.addEventListener('click', function(evento) {
        if (evento.target.tagName === 'BUTTON') {
            const nuevaUrl = evento.target.getAttribute('data-url');
            const nuevaPortada = evento.target.getAttribute('data-cover');
            const nombreEstacion = evento.target.textContent;
            cambiarEstacion(nuevaUrl, nuevaPortada, nombreEstacion);
            listaEstaciones.style.display = 'none';
        }
    });

    function cambiarEstacion(url, portada, nombre) {
        elementoAudio.src = url;
        imagenReproduciendo.src = portada;
        document.getElementById('artista').textContent = nombre;
        document.getElementById('cancion').textContent = '';
        if (estaReproduciendo) {
            elementoAudio.play().catch(e => {
                console.error('Error al reproducir nueva estación:', e);
                elementoEstado.textContent = 'No se puede reproducir la nueva estación';
            });
        }
        obtenerMetadatos();
    }

    // Obtención de metadatos
    function obtenerMetadatos() {
        fetch(elementoAudio.src)
            .then(respuesta => respuesta.headers.get('icy-metaint'))
            .then(metaint => {
                if (metaint) {
                    // Analizar metadatos aquí
                    console.log('Metadatos encontrados:', metaint);
                    // Actualizar UI con metadatos
                    actualizarMetadatos(metaint);
                } else {
                    console.log('No se encontraron metadatos');
                    elementoEstado.textContent = '';
                }
            })
            .catch(error => {
                console.error('Error al obtener metadatos:', error);
                elementoEstado.textContent = '';
            });
    }

    function actualizarMetadatos(metadatos) {

        const partes = metadatos.split('-');
        if (partes.length >= 2) {
            $("#cancion").text(partes[1].trim());
        } else {
            $("#cancion").text(metadatos);
        }
    }

    obtenerMetadatos();
    setInterval(obtenerMetadatos, 30000);

    let contextoAudio, analizador, fuente, nodoGanancia;
    const nodosEq = [];

    function configurarContextoAudio() {
        contextoAudio = new (window.AudioContext || window.webkitAudioContext)();
        analizador = contextoAudio.createAnalyser();
        fuente = contextoAudio.createMediaElementSource(elementoAudio);
        nodoGanancia = contextoAudio.createGain();

        const frecuencias = [32, 64, 125, 250, 500, 1000, 2000, 4000, 8000, 16000];
        frecuencias.forEach(freq => {
            const eq = contextoAudio.createBiquadFilter();
            eq.type = 'peaking';
            eq.frequency.value = freq;
            eq.Q.value = 1;
            eq.gain.value = 0;
            nodosEq.push(eq);
        });

        fuente.connect(nodosEq[0]);
        for (let i = 0; i < nodosEq.length - 1; i++) {
            nodosEq[i].connect(nodosEq[i + 1]);
        }
        nodosEq[nodosEq.length - 1].connect(nodoGanancia);
        nodoGanancia.connect(analizador);
        analizador.connect(contextoAudio.destination);

        analizador.fftSize = 64;

        const controlesEq = document.querySelectorAll('.control-ecualizador');
        controlesEq.forEach((control, indice) => {
            control.addEventListener('input', function() {
                nodosEq[indice].gain.value = parseFloat(this.value);
            });
        });
    }

    botonReproducirPausar.addEventListener('click', function() {
        if (!contextoAudio) {
            configurarContextoAudio();
        }
    });

    const longitudBuffer = 32;
    const arrayDatos = new Uint8Array(longitudBuffer);

    const visualizador = document.getElementById('visualizador-audio');

    for (let i = 0; i < 30; i++) {
        const barra = document.createElement('div');
        barra.className = 'barra';
        visualizador.appendChild(barra);
    }

    const barras = visualizador.querySelectorAll('.barra');

    function animar() {
        if (contextoAudio && estaReproduciendo) {
            analizador.getByteFrequencyData(arrayDatos);
            for (let i = 0; i < barras.length; i++) {
                const indice = Math.floor(i * longitudBuffer / barras.length);
                const valor = arrayDatos[indice] / 255;
                const altura = valor * 100;
                barras[i].style.height = `${altura}%`;
            }
        } else {
            barras.forEach(barra => {
                barra.style.height = '0%';
            });
        }

        requestAnimationFrame(animar);
    }

    animar();

    elementoAudio.addEventListener('error', function(e) {
        console.error('Error al cargar estación:', e);
        elementoEstado.textContent = 'Error al cargar la estación';
    });

    elementoAudio.addEventListener('waiting', function() {
        elementoEstado.textContent = 'Cargando...';
    });

    elementoAudio.addEventListener('canplay', function() {
        if (estaReproduciendo) {
            elementoEstado.textContent = 'Listo para reproducir';
        }
    });

    elementoAudio.addEventListener('playing', function() {
        elementoEstado.textContent = '';
    });

    const video = document.getElementById('video-fondo');
    
    function verificarTamanoVideo() {
        if (window.innerWidth / window.innerHeight < video.videoWidth / video.videoHeight) {
            video.style.width = '100%';
            video.style.height = 'auto';
        } else {
            video.style.width = 'auto';
            video.style.height = '100%';
        }
    }

    window.addEventListener('resize', verificarTamanoVideo);
    video.addEventListener('loadedmetadata', verificarTamanoVideo);
    verificarTamanoVideo();

    function reproducirVideo() {
        video.play().catch(error => {
            console.error("Se impidió la reproducción automática:", error);
        });
    }

    document.body.addEventListener('touchstart', reproducirVideo);
    reproducirVideo();

    document.addEventListener('click', function(evento) {
        if (!evento.target.closest('#alternarMenu') && !evento.target.closest('#listaMenu')) {
            listaMenu.style.display = 'none';
        }
        if (!evento.target.closest('#alternarEstaciones') && !evento.target.closest('#listaEstaciones')) {
            listaEstaciones.style.display = 'none';
        }
    });